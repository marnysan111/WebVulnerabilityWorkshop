import MySQLdb
import logging
import time

class DBManager():
    def connect_db(self, max_retries=10, delay=5):
        retries = 0
        while retries < max_retries:
            try:
                conn = MySQLdb.connect(
                    host="mysql",
                    user="admin",
                    db="traning",
                    passwd="P@ssW0rd",
                )
                return conn
            except Exception as error:
                logging.error("MySQL connection error: " + str(error))
                retries += 1
                time.sleep(delay)
                logging.info(f"Retrying connection ({retries}/{max_retries})...")

        logging.error("Failed to connect to MySQL after multiple retries.")
        return None