import MySQLdb
import os
from dotenv import load_dotenv
import logging
import time
load_dotenv()

class DBManager():
    def connect_db(self, max_retries=10, delay=5):
        retries = 0
        while retries < max_retries:
            try:
                conn = MySQLdb.connect(
                    host="mysql",
                    user="admin",
                    db="traning",
                    passwd=os.getenv('PASSWD'),
                )
                return conn
            except Exception as error:
                logging.error("MySQL connection error: " + str(error))
                retries += 1
                time.sleep(delay)
                logging.info(f"Retrying connection ({retries}/{max_retries})...")

        logging.error("Failed to connect to MySQL after multiple retries.")
        return None